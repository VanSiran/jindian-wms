<odoo>
  <data>
    <record model="ir.ui.view" id="geti_list_view">
      <field name="name">设备个体档案列表视图</field>
      <field name="model">wms.geti</field>
      <field name="arch" type="xml">
        <tree create="false" delete="false">
          <field name="beijian"/>
          <field name="beijianext"/>
          <field name="xuliehao"/>
          <field name="huowei"/>
          <field name="zhuangtai"/>
          <field name="changjia"/>
          <field name="shiyongshebei" widget="many2many_tags"/>
          <field name="pihao"/>
          <field name="shengchanriqi"/>
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="geti_ro_form_view">
      <field name="name">设备个体档案只读表视图</field>
      <field name="model">wms.geti</field>
      <field name="arch" type="xml">
        <form create="false" edit="false">
          <sheet>
            <field name="cangku" invisible="1"/>
            <field name="image" widget="zoomable_image" class="oe_avatar"/>
            <div class="oe_title">
              <button name="chuku" string="出库" type="object" class="btn btn-primary"
                attrs="{'invisible': [('zhuangtai', '!=', 'zaiku')]}"
                confirm="此操作不可撤销，是否继续出库？    (如误操作，请联系系统管理员。)"/>
              <span style="display:inline-block;width:10px"></span>
              <button name="%(wms.yiku_wizard_act_window)d" string="移库" type="action" class="btn btn-primary"
                attrs="{'invisible': [('zhuangtai', '!=', 'zaiku')]}"/>
              <span style="display:inline-block;width:10px"></span>
              <button name="jiance" string="检测通过" type="object" class="btn btn-default"
                attrs="{'invisible': ['|',('zhuangtai', '!=', 'zaiku'),('jiancedaoqiri','=',False)]}"
                confirm="此操作不可撤销，是否确定检测已通过？    (如误操作，请联系系统管理员。)"/>
              <span style="display:inline-block;width:10px"></span>
              <button name="baofei" string="报废" type="object" class="btn btn-default"
                attrs="{'invisible': [('zhuangtai', '=', 'baofei')]}"
                confirm="此操作不可撤销，是否确定备件已报废？    (如误操作，请联系系统管理员。)"/>
            </div>
            <group>
              <group>
                <field name="beijian" readonly="1"/>
                <field name="beijianext" readonly="1"/>
                <field name="shiyongshebei" readonly="1" widget="many2many_tags"/>
              </group>
              <group>
                <field name="xuliehao" readonly="1"/>
                <field name="zhuangtai" readonly="1"/>
                <field name="huowei" readonly="1"
                  attrs="{'invisible': [('zhuangtai', '=', 'chuku')]}"/>
                <field name="cangku" readonly="1"
                  attrs="{'invisible': [('zhuangtai', '!=', 'chuku')]}"/>
              </group>
            </group>
            <group>
              <group>
                <field name="changjia" readonly="1"/>
                <field name="pihao" readonly="1"/>
              </group>
              <group>
                <field name="shengchanriqi" readonly="1"/>
                <field name="jiancedaoqiri" readonly="1"/>
              </group>
            </group>
            <field name="lishijilu" readonly="1"/>
          </sheet>
        </form>
      </field>
    </record>

    <record id="geti_search_view" model="ir.ui.view">
        <field name="name">个体搜索视图</field>
        <field name="model">wms.geti</field>
        <field name="arch" type="xml">
            <search string="备件个体筛选查询">
                <field name="beijian" string="备件名称" filter_domain="['|', ('beijian.suoxie', 'ilike', self), ('beijian.name', 'ilike', self)]"/>
                <field name="cangku" string="仓库" filter_domain="['|', ('cangku.suoxie', 'ilike', self), ('cangku.name', 'ilike', self)]"/>
                <filter name="zaiku" string="在库" domain="[('zhuangtai', '=', 'zaiku')]"/>
                <filter name="chuku" string="出库" domain="[('zhuangtai', '=', 'chuku')]"/>
                <!-- <field name="categ_id" filter_domain="[('categ_id', 'child_of', raw_value)]"/>               <separator/>
                <filter string="Services" name="services" domain="[('type','=','service')]"/>
                <filter string="Products" name="consumable" domain="[('type', 'in', ['consu', 'product'])]"/>
                <separator/>
                <filter string="Can be Sold" name="filter_to_sell" domain="[('sale_ok','=',1)]"/>
                <filter string="Can be Purchased" name="filter_to_purchase" domain="[('purchase_ok', '=', 1)]"/>
                <separator/>
                <filter string="Archived" name="inactive" domain="[('active','=',False)]"/>
                <field string="Attributes" name="attribute_line_ids" groups="product.group_product_variant"/>
                <field name="pricelist_id" widget="selection" context="{'pricelist': self}" filter_domain="[]" groups="product.group_sale_pricelist"/>  -->
                <!-- Keep widget=selection on this field to pass numeric `self` value, which is not the case for regular m2o widgets! -->
                <separator/>
                <!-- <filter string="Late Activities" name="activities_overdue"
                    domain="[('activity_ids.date_deadline', '&lt;', context_today().strftime('%Y-%m-%d'))]"
                    help="Show all records which has next action date is before today"/>
                <filter string="Today Activities" name="activities_today"
                    domain="[('activity_ids.date_deadline', '=', context_today().strftime('%Y-%m-%d'))]"/>
                <filter string="Future Activities" name="activities_upcoming_all"
                    domain="[('activity_ids.date_deadline', '&gt;', context_today().strftime('%Y-%m-%d'))
                    ]"/> -->
            </search>
        </field>
    </record>

    <!-- <record id="geti_act_window" model="ir.actions.act_window">
      <field name="name">备件个体档案</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">wms.geti</field>
      <field name="view_type">form</field>
      <field name="view_mode">tree,form</field>
      <field name="search_view_id" ref="wms.geti_search_view"/>
      <field name="context">{'group_by':'cangku', 'search_default_zaiku': 1}</field>
    </record> -->

    <record id="geti_act_window" model="ir.actions.server">
      <field name="name">备件个体档案</field>
      <field name="model_id" ref="model_wms_geti"/>
      <field name="state">code</field>
      <field name="code">if len(user.cangku.child_id) > 0:
    action = {"type": "ir.actions.act_window", "name":"备件个体档案","view_type":"form", "view_mode": "tree,form", "res_model": "wms.geti", "context": {'group_by':'cangku','search_default_zaiku': 1}}
else:
    action = {"type": "ir.actions.act_window", "name":"备件个体档案","view_type":"form", "view_mode": "tree,form", "res_model": "wms.geti", "context": {'search_default_zaiku': 1}}
      </field>
    </record>

  </data>
</odoo>
